
<html>
<head>
  <title>Video Comforter</title>
  <link rel="stylesheet" href="style.css">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
  <script type="text/javascript" src="http://cdn.peerjs.com/0.3/peer.js"></script>
  <script type="text/javascript" src="speech.js"></script>
  <script type="text/javascript" src="model_pca_20_svm.js"></script>
  <script type="text/javascript" src="clm.js"></script>
  <script type="text/javascript" src="chat.js"></script>
</head>

<body>

  <div id="container" class="pure-g">
      <div id="link"></div>

    <!-- Video area -->
    <div class="pure-u-2-3" id="video-container">
      <video id="their-video"  autoplay></video>

      <div id="me">
        <video id="my-video" width="280" height="210" muted="true" autoplay></video>
        <canvas id="overlay" width="280" height="210" ></canvas>
      </div>
      
      <div id="positions"></div>

    </div>

    <!-- Steps -->
    <div class="pure-u-1-3">
      <h2>Video Comforter</h2>
      <h5>Project description here...</h5>
      <!-- Get local audio/video stream -->
      <div id="step1">
        <p>Please click `allow` on the top of the screen so we can access your webcam and microphone for calls.</p>
        <div id="step1-error">
          <p>Failed to access the webcam and microphone. Make sure to run this demo on an http server and click allow when asked for permission by the browser.</p>
          <a href="#" class="pure-button pure-button-error" id="step1-retry">Try again</a>
        </div>
      </div>

      <!-- Make calls to others -->
      <div id="step2">
        <p>Your id: <span id="my-id">...</span></p>
        <p>Share this id with others so they can call you.</p>


        <h3>Make a call</h3>
        <div class="pure-form">
          <input type="text" placeholder="Call user id..." id="callto-id">
          <a href="#" class="pure-button pure-button-success" id="make-call">Call</a>
        </div>
      </div>

      <!-- Call in progress -->
      <div id="step3">
        <p>Currently in call with <span id="their-id">...</span></p>
        <p><a href="#" class="pure-button pure-button-error" id="end-call">End call</a></p>
      </div>

      <div id="step5">

<!--
        <div class="pure-form">
          <input type="text" placeholder="Message to send..." id="data-msg">
          <a href="#" class="pure-button pure-button-success" id="send-data">Send</a>
        </div>

        <div class="pure-form">
          <a href="#" class="pure-button pure-button-success" id="start-speech">Start speech</a>
          <a href="#" class="pure-button pure-button-success" id="start-tracking" >Start tracking</a>
        </div>
-->
        
        <div class="pure-form">
          <a href="#" class="pure-button pure-button-success" id="start-tracking">Start tracking</a>
        </div>
        </div>

    </div>
  </div>
     	<script>
				// JQUERY + INTERACTION

				//testing with key press
				$(document).keydown(function(event){
            		if(event.which == 75){ // k
                		frameFade(true, function() {
                           
                			$( "#link" ).show(1700);
                		});
            		}
            		if(event.which == 74) { // j
            			frameFade(false, function(){
                            
            				$( "#link" ).show(1700);
            			});
            		}
    			});
     			
    			function frameFade(message,showLink) {
    				if (message == false) {
    					$("#their-video, #my-video, #link").stop().animate({
    						borderColor:pastelColors()},
    						1700, function(){
    						$(this).animate({borderColor:pastelColors()},1000);
						});
					}
					else if (message == true) {
    					$("#their-video, #my-video, #link").stop().animate({
    						borderColor:pastelColors()},
    						1700);
					};

					showLink();
				};				
				
				function pastelColors(){
    				var r = (Math.round(Math.random()* 127) + 127).toString(16);
    				var g = (Math.round(Math.random()* 127) + 127).toString(16);
    				var b = (Math.round(Math.random()* 127) + 127).toString(16);
                   //alert('#' + r + g + b);
    				return '#' + r + g + b;
				}

				

		</script>
    
    
</body>
</html>
